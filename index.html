<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Builder</title>
    <script type="text/javascript" src="renderer.js"></script>
  </head>

  <body style="margin:0;">
  <canvas id="outputTarget"></canvas>
    <script type="text/javascript">
	var debug = true;
    
	var manager = new Worker("manager.js");
	var canvas = document.getElementById("outputTarget");
	
	var maxWidth = window.innerWidth;
	var maxHeight = window.innerHeight;
	maxWidth = Math.min(maxWidth,maxHeight);
	maxHeight = maxWidth;
	
	var bWidth=1;
	var bHeight=1;
	
	manager.onmessage = function(e){
	    if (e.data.msg==="world")
	    {
		if (debug)
		{
		    console.log("Recieved data to render");
		    console.log(e.data)
		}
		bWidth = Math.max(1,Math.floor(maxWidth/e.data.world.length));
		bHeight = Math.max(1,Math.floor(maxHeight/e.data.world[0].length));
		Renderer.render(canvas,e.data.world,bWidth,bHeight);
	    }
	    else if (e.data.msg==="agentpath")
	    {		
		if (debug)
		    console.log("Recieved path to render");
		Renderer.renderPath(canvas,e.data.points,bWidth,bHeight)
	    }
	};
	
	manager.postMessage("start");
	if (debug)
	  console.log("Started Manager");

    </script>
  </body>
</html>
